FROM amancevice/pandas:2.0.2-slim

WORKDIR /app

COPY requirements.txt requirements.txt

RUN pip install -r requirements.txt

ARG APP_PORT
ARG APP_RUN_TYPE
ARG AZURE_CONN_STR
ARG AZURE_CREDENTIAL
ARG AZURE_CONTAINER_NAME
ARG KAFKA_HOST
ARG KAFKA_PORT
ARG KEYCLOAK_HOST
ARG KEYCLOAK_PORT
ARG KEYCLOAK_REALM_NAME
ARG KEYCLOAK_CLIENT_ID
ARG KEYCLOAK_CLIENT_SECRET_KEY

ENV saas_APP_PORT=$APP_PORT
ENV saas_APP_RUN_TYPE=$APP_RUN_TYPE
ENV saas_AZURE_CONN_STR=$AZURE_CONN_STR
ENV saas_AZURE_CREDENTIAL=$AZURE_CREDENTIAL
ENV saas_AZURE_CONTAINER_NAME=$AZURE_CONTAINER_NAME
ENV saas_KAFKA_HOST=$KAFKA_HOST
ENV saas_KAFKA_PORT=$KAFKA_PORT
ENV saas_KEYCLOAK_HOST=$KEYCLOAK_HOST
ENV saas_KEYCLOAK_PORT=$KEYCLOAK_PORT
ENV saas_KEYCLOAK_REALM_NAME=$KEYCLOAK_REALM_NAME
ENV saas_KEYCLOAK_CLIENT_ID=$KEYCLOAK_CLIENT_ID
ENV saas_KEYCLOAK_CLIENT_SECRET_KEY=$KEYCLOAK_CLIENT_SECRET_KEY

COPY . .

EXPOSE $APP_PORT

CMD ["python3", "app.py"]